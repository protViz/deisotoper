package ch.fgcz.proteomics.R;

/**
 * @author Lucas Schmidt
 * @since 2017-11-20
 */

import org.junit.Test;

// TODO: Finish tests for FeaturesBasedDeisotoping!
public class FeaturesBasedDeisotopingTest {
    @Test
    public void test() {
        // double[] mz = { 112.0871735, 113.0711823, 114.0663681, 114.1508865,
        // 115.0868149, 115.7491302, 116.0708923,
        // 118.1549301, 120.7750015, 129.0659332, 129.1022644, 129.1135406, 130.0863495,
        // 130.0976105, 131.1179047,
        // 136.0345459, 140.0706024, 142.1991882, 143.1179199, 144.1213837, 145.0879517,
        // 147.0763702, 147.1127777,
        // 148.1159668, 150.2468414, 151.1396484, 155.0813751, 155.7362823, 157.1083527,
        // 158.0923157, 158.5955658,
        // 159.0761871, 159.0960236, 165.9717255, 166.8220825, 167.0552063, 167.0815125,
        // 168.0654602, 168.0769653,
        // 169.0607452, 170.1289063, 171.0767975, 171.1127777, 171.1868134, 172.1161652,
        // 172.3614044, 172.9120483,
        // 173.0923157, 175.118988, 176.122345, 176.541214, 181.0605011, 183.0763855,
        // 184.108078, 185.0920563,
        // 186.0871887, 187.0715332, 188.1392517, 194.092392, 195.0761719, 198.0872345,
        // 199.071167, 199.180481,
        // 201.0870972, 202.1185455, 204.13414, 210.6521301, 210.6576233, 211.1188354,
        // 212.1028137, 213.0869141,
        // 213.1059875, 213.15979, 216.0977936, 217.1367493, 227.1752777, 228.1337738,
        // 228.1452637, 229.1295319,
        // 230.1133118, 236.118866, 239.0948792, 242.1495209, 243.1340942, 244.0924835,
        // 244.165451, 245.1238403,
        // 246.155838, 247.1591187, 250.277832, 254.1127319, 256.1399841, 256.6082764,
        // 258.1081238, 258.1445313,
        // 260.1969299, 261.2000732, 262.1159973, 264.0973206, 264.133606, 266.1714172,
        // 271.12146, 271.176239,
        // 276.1549377, 279.6346436, 280.1268005, 281.1242371, 281.1604919, 282.1080017,
        // 288.6399841, 294.0384521,
        // 299.1343689, 299.1708374, 300.1184387, 314.0976257, 314.1928711, 317.1450806,
        // 321.6452942, 323.6850281,
        // 326.1456604, 331.1244812, 343.1722717, 344.1557922, 357.1397705, 358.2082825,
        // 361.1824951, 361.5554504,
        // 362.1861877, 368.1562805, 368.3327332, 373.5584106, 376.1773682, 376.6688232,
        // 377.1610413, 382.2084656,
        // 385.1346741, 385.1826172, 385.6742859, 385.6863403, 392.1560364, 394.187561,
        // 394.6898804, 400.2182617,
        // 402.2453308, 410.1661072, 414.1617737, 418.9945679, 423.7244873, 424.2259216,
        // 427.192749, 427.2776794,
        // 432.1717529, 433.7039185, 442.1575317, 470.3086243, 471.2301636, 471.2921448,
        // 472.2147827, 479.2405396,
        // 479.7420349, 488.0892944, 488.2456665, 488.2642212, 488.3190613, 488.7481689,
        // 489.2411804, 490.2441101,
        // 506.1994019, 514.3092041, 524.2105103, 525.1936646, 541.2365112, 542.2203369,
        // 543.2036743, 543.223938,
        // 558.2633057, 559.2462158, 576.2731323, 577.2757568, 596.3707275, 601.0432739,
        // 613.2590942, 615.2833862,
        // 629.3374634, 633.2954102, 634.298584, 635.2976685, 641.3005981, 642.2839966,
        // 659.310791, 660.2923584,
        // 660.319397, 669.2980957, 677.3210449, 678.3242798, 687.3051758, 726.3154297,
        // 727.3358154, 740.3660889,
        // 752.3312378, 758.3781128, 767.5574341, 769.3585815, 769.4901733, 770.3423462,
        // 771.3450317, 787.3690796,
        // 788.3511963, 789.3549194, 805.3795166, 806.3829346, 819.3829346, 927.8114014,
        // 953.1741333 };
        // double[] intensity = { 5019.9853515625, 1145.3111572266, 1953.1070556641,
        // 1172.1873779297, 3960.1809082031,
        // 839.7935791016, 4655.0498046875, 719.9886474609, 814.3889770508,
        // 3317.5708007813, 7375.2182617188,
        // 799.5717773438, 1043.6796875, 1106.4193115234, 1407.7196044922,
        // 799.7190551758, 9113.3115234375,
        // 832.2332763672, 226039.609375, 8959.166015625, 823.1025390625,
        // 1381.5020751953, 6235.826171875,
        // 923.6351928711, 854.1689453125, 726.7661743164, 4021.6694335938,
        // 850.2911376953, 1726.728515625,
        // 18144.697265625, 725.1481323242, 1323.8914794922, 763.1874389648,
        // 721.2479248047, 846.6802978516,
        // 1345.7283935547, 1644.2734375, 1477.3209228516, 1077.8731689453,
        // 1095.3635253906, 3402.4599609375,
        // 1231.0843505859, 52182.33203125, 812.8557128906, 3476.0922851563,
        // 915.5633544922, 1047.14453125,
        // 3994.8283691406, 54741.9921875, 1749.3200683594, 778.1806030273,
        // 2934.1872558594, 3179.5603027344,
        // 11858.4072265625, 14666.845703125, 1431.6451416016, 1315.6446533203,
        // 7097.82421875, 1675.9538574219,
        // 6308.7470703125, 3635.0944824219, 1221.1094970703, 1603.2238769531,
        // 1343.9724121094, 5381.626953125,
        // 987.3547363281, 1333.5249023438, 3679.65234375, 1402.1759033203,
        // 16679.318359375, 14325.8095703125,
        // 925.2255859375, 1124.0841064453, 8431.1328125, 1641.5587158203,
        // 1000.3626708984, 1487.0086669922,
        // 1186.0378417969, 9778.3837890625, 10239.0478515625, 1795.9494628906,
        // 1194.8146972656, 4480.7036132813,
        // 1282.6400146484, 6113.8134765625, 9531.107421875, 6363.4838867188,
        // 231863.6875, 12270.2880859375,
        // 811.7547607422, 5949.4350585938, 1187.3803710938, 7442.1396484375,
        // 859.6772460938, 4076.056640625,
        // 1076.7104492188, 803.2047729492, 1456.7014160156, 1435.8338623047,
        // 1509.025390625, 13125.126953125,
        // 3695.03515625, 3730.8666992188, 1608.7591552734, 961.1223754883,
        // 12496.140625, 4852.7260742188,
        // 1708.9411621094, 3150.1843261719, 3763.1657714844, 823.167175293,
        // 8059.3515625, 11665.0146484375,
        // 1232.3054199219, 4382.1298828125, 1043.6394042969, 3930.4025878906,
        // 1258.4643554688, 3255.1252441406,
        // 876.9732055664, 8034.0249023438, 1201.9855957031, 7386.0473632813,
        // 1461.3604736328, 974.329284668,
        // 32234.666015625, 786.2280273438, 1463.4792480469, 6965.8876953125,
        // 824.1337280273, 750.8676757813,
        // 1204.7540283203, 1744.8153076172, 1821.0963134766, 1783.2720947266,
        // 915.9514770508, 12835.7958984375,
        // 4688.4990234375, 1033.2008056641, 4471.2685546875, 39548.0546875,
        // 6963.7475585938, 1286.8359375,
        // 816.2501220703, 1498.9143066406, 1175.2182617188, 6722.90625,
        // 3536.2565917969, 974.1317138672,
        // 3465.4177246094, 1340.171875, 4821.6938476563, 901.6002807617,
        // 1253.0863037109, 1352.3179931641,
        // 1893.4539794922, 5254.7958984375, 14662.119140625, 9999.751953125,
        // 1769.4927978516, 2743.2465820313,
        // 13088.3388671875, 1672.9213867188, 74647, 2883.6926269531, 24178.904296875,
        // 1837.3953857422,
        // 833.9572143555, 1545.6541748047, 6409.177734375, 3217.1665039063,
        // 3206.1813964844, 16587.966796875,
        // 2935.0837402344, 3302.4555664063, 3774.6899414063, 8306.556640625,
        // 78383.7734375, 13244.69140625,
        // 908.2634277344, 931.9086914063, 1403.2158203125, 1237.3208007813,
        // 1782.6771240234, 8827.2744140625,
        // 1186.0920410156, 953.5983276367, 1205.8293457031, 1300.4996337891,
        // 7886.1782226563, 3246.3686523438,
        // 1257.3724365234, 932.6938476563, 141611.28125, 26173.603515625,
        // 5824.7529296875, 1703.7838134766,
        // 935.6262817383, 1196.9497070313, 1043.5474853516, 1375.9307861328,
        // 937.7045288086, 4368.6743164063,
        // 868.6353759766, 14076.8505859375, 1663.6213378906, 22441.501953125,
        // 40263.48828125, 7578.0766601563,
        // 48826.28125, 11930.2041015625, 1293.1002197266, 908.5403442383,
        // 919.8944702148 };

        // double[] mz = { 0.2, 1.0, 2.0, 2.5, 4.0, 5.0, 6.0, 7.0, 9.0, 10.0, 11.0,
        // 12.0, 13.0, 17.0, 18.0, 19.0, 21.0,
        // 23.0, 111.0 };
        // double[] intensity = { 0.2, 1.0, 2.0, 2.5, 4.0, 5.0, 6.0, 7.0, 9.0, 10.0,
        // 11.0, 12.0, 13.0, 17.0, 18.0, 19.0,
        // 21.0, 23.0, 111.0 };

        double[] mz = { 101.0, 102.0, 102.5, 103.0 };
        double[] intensity = { 1.0, 1.0, 1.0, 1.0 };

        // double[] mz = { 1011.0, 1012.0, 1015.0, 1016.0 };
        // double[] intensity = { 1.0, 1.0, 1.0, 1.0 };

        FeaturesBasedDeisotoping dtoper = new FeaturesBasedDeisotoping();

        double[] aa = { 99.06841 };

        dtoper.setConfiguration(aa, 0.8, 0.5, 0.1, 0.1, 0.1, 0.003, 0.3, 1.0, 0, false, "first");

        dtoper.setMz(mz);
        dtoper.setIntensity(intensity);
        dtoper.setPepMass(1.2345);
        dtoper.setCharge(2);

        dtoper.deisotope();

        double[] mzout = dtoper.getMz();
        double[] intensityout = dtoper.getIntensity();

        System.out.println("Input Peaklist (" + mz.length + "):   Output Peaklist(" + mzout.length + "):");
        for (int i = 0; i < mz.length || i < intensity.length; i++) {
            System.out.print(mz[i] + " ");
            System.out.print(intensity[i] + "    ");
            if (i < mzout.length || i < intensityout.length) {
                System.out.print(mzout[i] + " ");
                System.out.print(intensityout[i]);
            } else {
                System.out.print(" ");
            }

            System.out.println();
        }
        System.out.println();

        // System.out.println("Peaks who are in input and not anymore in output:");
        // List<Double> mzlist = new ArrayList<>();
        // List<Double> intensitylist = new ArrayList<>();
        // List<Double> mzoutlist = new ArrayList<>();
        // List<Double> intensityoutlist = new ArrayList<>();
        // for (int i = 0; i < mz.length; i++) {
        // mzlist.add(mz[i]);
        // intensitylist.add(intensity[i]);
        // }
        //
        // for (int i = 0; i < mzout.length; i++) {
        // mzoutlist.add(mzout[i]);
        // intensityoutlist.add(intensityout[i]);
        // }
        //
        // mzlist.removeAll(mzoutlist);
        // intensitylist.removeAll(intensityoutlist);
        //
        // for (int i = 0; i < mzlist.size(); i++) {
        // System.out.println(mzlist.get(i) + " " + intensitylist.get(i));
        // }

        // System.out.println();
        // System.out.println(dtoper.getSummary());
        // System.out.println();
        // System.out.println(dtoper.getConfiguration());
        System.out.println();
        System.out.println(dtoper.getAnnotatedSpectrum());
        // dtoper.setMz(mz2);
        // dtoper.setIntensity(intensity2);
        // dtoper.setPepMass(1.2345);
        // dtoper.setCharge(2);
        //
        // dtoper.deisotope();
        //
        // double[] mzout2 = dtoper.getMz();
        // double[] intensityout2 = dtoper.getIntensity();
        //
        // System.out.println("Input Peaklist (" + mz2.length + "): Output Peaklist(" +
        // mzout2.length + "):");
        // for (int i = 0; i < mz2.length || i < intensity2.length; i++) {
        // System.out.print(mz2[i] + " ");
        // System.out.print(intensity2[i] + " ");
        // if (i < mzout2.length || i < intensityout2.length) {
        // System.out.print(mzout2[i] + " ");
        // System.out.print(intensityout2[i]);
        // } else {
        // System.out.print(" ");
        // }
        //
        // System.out.println();
        // }
        // System.out.println();
        //
        // System.out.println("Peaks who are in input and not anymore in output:");
        // List<Double> mzlist2 = new ArrayList<>();
        // List<Double> intensitylist2 = new ArrayList<>();
        // List<Double> mzoutlist2 = new ArrayList<>();
        // List<Double> intensityoutlist2 = new ArrayList<>();
        // for (int i = 0; i < mz.length; i++) {
        // mzlist2.add(mz[i]);
        // intensitylist2.add(intensity[i]);
        // }
        //
        // for (int i = 0; i < mzout2.length; i++) {
        // mzoutlist2.add(mzout2[i]);
        // intensityoutlist2.add(intensityout2[i]);
        // }
        //
        // mzlist2.removeAll(mzoutlist2);
        // intensitylist2.removeAll(intensityoutlist2);
        //
        // for (int i = 0; i < mzlist2.size(); i++) {
        // System.out.println(mzlist2.get(i) + " " + intensitylist2.get(i));
        // }
        // System.out.println();
        // System.out.println(dtoper.getSummary());
        // System.out.println();
        // System.out.println(dtoper.getConfiguration());
        // System.out.println();
        // System.out.println(dtoper.getAnnotatedSpectrum());
        // System.out.println();
        // System.out.println(dtoper.getDot()[1]);
    }
}
